# 错误信息说明

本文档列出大模型测试工具可能遇到的常见错误信息及其原因和解决方案。

> **说明**: 本文档基于实际测试1128个模型的结果编写，包含真实案例和统计数据。

## 错误频率统计

根据实际测试结果：
- **HTTP_403 (禁止访问)**: 约40-50%的失败 ⚠️ **最常见**
- **HTTP_429 (请求过多)**: 约20-30%的失败 ⚠️ **第二常见**
- **HTTP_400 (错误请求)**: 约5-10%的失败
- **HTTP_404 (未找到)**: 约3-5%的失败
- **HTTP_500/502/503 (服务器错误)**: 约2-5%的失败
- **其他错误**: 约5-10%的失败

---

## HTTP 状态码错误

### HTTP_400 - 错误的请求
**频率**: 约5-10%的失败

**实际案例**:
- `@cf/lykon/dreamshaper-8-lcm` - 图像生成模型
- `Kolors`, `FLUX.1`系列 - 图像模型
- `Meta-Llama-3-70B-Instruct` - 接口不匹配
- `bge-reranker-v2-m3` - Reranker模型
- `cogvideox-flash` - 视频生成模型

**原因：**
- 非语言模型（图像、音频、视频生成）不支持chat completions接口
- 请求参数格式不符合特定模型要求
- 模型需要特殊的请求格式（如reranker、embedding需要不同接口）
- 模型ID格式错误或拼写错误

**解决方案：**
- 工具已自动识别常见非语言模型并使用连通性测试
- 对于未识别的模型，请查看API文档确认正确的调用方式
- 检查模型是否支持OpenAI兼容的chat completions接口
- 如果是特殊用途模型（embedding、reranker），请使用对应的接口

---

### HTTP_401 - 未授权
**原因：**
- API密钥无效、过期或格式错误
- API密钥未提供或格式不正确
- 密钥权限不足

**解决方案：**
- 检查 `--api-key` 参数是否正确
- 确认API密钥有效且未过期
- 在API提供商后台检查密钥状态和权限
- 重新生成API密钥

---

### HTTP_403 - 禁止访问 ⚠️ **最常见错误**
**频率**: 约40-50%的失败（测试中最常见的错误）

**实际案例**:
- **Claude系列**: `claude-3-5-sonnet-20241022`, `claude-3-haiku-20240307`, `command-r`, `command-r-plus`
- **GPT系列**: `gpt-4`, `deepseek-chat`
- **Gemini系列**: `gemini-1.5-flash-latest`, `gemini-1.5-pro`, `gemini-2.0-pro-exp`
- **GLM系列**: `glm-4-flash`, `glm-4-plus`, `glm-4v`
- **Qwen系列**: `Qwen/Qwen1.5-110B-Chat`, 多个高端版本
- **其他**: `Kimi K2`, `deepseek-ai/DeepSeek-R1`, `MiniMax-M1-80k`

**原因：**
- **最常见**: API密钥没有访问该模型的权限（账户等级不足）
- 账户未开通该模型的使用权限（需要单独申请或付费）
- 模型为企业版或高级版，需要特殊授权
- 部分模型仅对特定用户或地区开放
- API密钥权限范围受限

**解决方案：**
1. **检查账户权限**: 登录API提供商后台，查看可用模型列表
2. **申请访问权限**: 
   - 联系API提供商申请模型访问权限
   - 某些模型需要填写申请表单或审核
3. **升级套餐**: 部分高端模型需要升级到企业版或高级套餐
4. **使用替代模型**: 选择相同提供商的其他可用模型
5. **验证API密钥**: 确保使用的是正确的API密钥且未过期

**重要提示**: 如果大量模型返回HTTP_403，说明您的API密钥可能权限不足，建议先确认可用模型列表后再进行测试。

---

### HTTP_404 - 资源未找到
**频率**: 约3-5%的失败

**实际案例**:
- **音频模型**: `@cf/openai/whisper`, `FunAudioLLM/CosyVoice2-0.5B`, `fishaudio/fish-speech-1.4`
- **图像模型**: `Qwen/Qwen-Image`, `Qwen/Qwen-Image-Edit`
- **TTS模型**: `IndexTeam/IndexTTS-2`, `TeleAI/TeleSpeechASR`
- **Embedding模型**: `Qwen/Qwen3-Embedding-0.6B`, `MusePublic/Qwen-Image-Edit`

**原因：**
- 模型ID不存在、拼写错误或已下线
- 模型已被重命名或迁移到新的ID
- API端点路径错误（非标准OpenAI格式）
- 模型仅在特定版本的API中可用

**解决方案：**
1. **验证模型ID**: 
   - 查看API提供商的最新模型列表
   - 确认模型ID拼写完全正确（区分大小写）
2. **检查模型状态**: 
   - 模型可能已下线或不再提供服务
   - 查找模型的替代版本或继任者
3. **确认Base URL**: 
   - 某些模型可能需要特定的base URL
   - 检查API文档中的正确端点
4. **联系支持**: 如果确定模型应该存在，联系API提供商技术支持

---

### HTTP_408 - 请求超时
**原因：**
- 客户端请求建立连接超时
- 服务器等待客户端发送请求超时

**解决方案：**
- 增加 `--timeout` 参数值（默认30秒）
- 检查网络连接稳定性
- 重试请求

---

### HTTP_429 - 请求过多 ⚠️ **第二常见错误**
**频率**: 约20-30%的失败（在批量测试时非常常见）

**实际案例**:
- **GPT系列**: `gpt-3.5-turbo-16k`, `gpt-3.5-turbo-1106`, `gpt-3.5-turbo-0613`
- **Gemini系列**: `gemini-1.5-flash`, `gemini-2.5-pro`, `gemini-exp-1206`
- **DeepSeek系列**: 多个版本频繁触发速率限制
- **GLM系列**: `GLM-4.5`, `GLM-4.6-Search`, `glm-4-flash-250414`
- **Mistral**: `mistral-small-latest`, `codestral-2501`
- **其他**: `claude-3-7-sonnet`, 多个free版本

**原因：**
- **最常见**: 批量测试1000+模型时触发API速率限制（QPM/RPM/TPM）
- 短时间内对同一提供商的多个模型发送请求
- API套餐的并发请求数限制
- 某些free版本有更严格的速率限制
- 账户剩余配额不足

**解决方案：**
1. **增加测试间隔**: 
   - 在测试大量模型时添加延迟（建议每个请求间隔1-2秒）
   - 避免短时间内密集测试
2. **分批次测试**: 
   - 将1000+模型分成多个批次
   - 每批次之间休息5-10分钟
3. **升级API套餐**: 
   - 升级到更高级的套餐以提高QPM/RPM限制
   - 购买更多的API配额
4. **优先测试重要模型**: 
   - 先测试常用或重要的模型
   - 对不重要的模型可以跳过
5. **使用重试机制**: 
   - 遇到429错误后等待60秒再重试
   - 可以在晚上或使用量低的时段重试

**重要提示**: 如果持续遇到HTTP_429，说明您的测试频率太高。建议：
- 减少同时测试的模型数量
- 增加测试间隔时间
- 或升级API套餐获得更高的速率限制

---

### HTTP_500 - 服务器内部错误
**频率**: 约2-3%的失败

**实际案例**:
- **图像生成**: `Doubao-Seedream-3.0-t2i`, `Doubao-Seedance-1.0-pro`
- **视频生成**: `Doubao-Seedance-1.0-lite-t2v`, `Wan2.1-14B`
- **大模型**: `Spark Max`, `gemini-2.5-flash`, `gemini-2.5-pro`

**原因：**
- 模型服务内部错误或崩溃
- 请求触发了服务器bug
- 模型正在更新或维护
- 服务器资源不足导致处理失败

**解决方案：**
1. **等待重试**: 等待5-10分钟后重试
2. **检查服务状态**: 查看API提供商的服务状态页面
3. **更换模型**: 使用相同功能的其他模型
4. **联系支持**: 如果持续出现，联系技术支持并提供错误详情

---

### HTTP_502 - 网关错误
**频率**: 约1-2%的失败

**实际案例**:
- `claude-sonnet-4-20250514`
- `claude-sonnet-4-5-20250929`

**原因：**
- API网关无法连接到后端模型服务
- 上游服务器响应超时
- 网关配置问题
- 负载均衡器故障

**解决方案：**
1. **立即重试**: 网关错误通常是临时的
2. **等待恢复**: 如果持续出现，等待10-30分钟
3. **检查公告**: 查看API提供商是否有维护公告
4. **切换端点**: 如果提供商有多个base URL，尝试切换

---

### HTTP_503 - 服务不可用
**频率**: 约1-2%的失败

**实际案例**:
- `THUDM/GLM-4.1V-9B-Thinking`
- `deepseek-v3`
- `deepseek-ai/DeepSeek-R1-0528-Qwen3-8B`

**原因：**
- 服务器正在维护
- 模型服务临时下线或重启
- 服务器过载无法处理新请求
- 模型正在部署新版本

**解决方案：**
1. **查看公告**: 检查API提供商的维护公告或状态页面
2. **延迟重试**: 等待30分钟到1小时后重试
3. **错峰使用**: 在使用量较低的时段（如凌晨）重试
4. **使用备用模型**: 临时切换到其他可用模型

---

### HTTP_554 - 交易失败 / 服务配置错误
**频率**: 罕见（<1%）

**实际案例**:
- `yi-lightning`
- `GLM-4_5`
- `Qwen/Qwen3-32B-FP8`
- `Qwen/Qwen3-Next-80B-A3B-Instruct`
- `deepseek-ai/DeepSeek-R1`

**原因：**
- 模型服务配置错误
- 模型版本不兼容
- 内部路由或转发错误
- 特定模型的服务异常

**解决方案：**
1. **更换模型版本**: 尝试该模型的其他版本（如standard版本替代FP8版本）
2. **联系支持**: 这通常是服务端配置问题，需要API提供商修复
3. **使用替代模型**: 选择功能相似的其他模型
4. **稍后重试**: 可能是临时性问题，几小时后重试

---

### HTTP_402 - 需要付费
**频率**: 罕见（<1%）

**实际案例**:
- `gpt-5-2025-08-07`

**原因：**
- 模型需要额外付费或订阅才能访问
- 账户余额不足
- 未开通特定的付费功能
- 超出免费额度

**解决方案：**
1. **充值账户**: 为账户充值或购买更多credits
2. **订阅服务**: 某些高级模型需要订阅特定套餐
3. **查看定价**: 确认模型的使用费用和计费方式
4. **使用免费模型**: 选择不需要额外付费的模型

---

### HTTP_504 - 网关超时
**原因：**
- 上游服务器响应超时
- 模型推理时间过长
- 网络延迟过高

**解决方案：**
- 增加 `--timeout` 参数值
- 检查网络连接质量
- 尝试在网络状况较好时测试
- 考虑使用响应速度更快的模型

---

## 连接相关错误

### TIMEOUT - 请求超时
**原因：**
- 网络连接速度慢
- 服务器响应时间超过设定的超时时间
- 模型推理时间过长

**解决方案：**
- 增加超时设置：`--timeout 60`（单位：秒）
- 检查网络连接
- 确认API服务器是否正常运行
- 尝试使用更快的网络连接

---

### CONN_FAILED - 连接失败
**原因：**
- 无法连接到API服务器
- DNS解析失败
- 网络不通
- 防火墙阻止连接
- Base URL错误

**解决方案：**
- 检查 `--base-url` 参数是否正确
- 确认网络连接正常
- 检查防火墙或代理设置
- 尝试 ping 服务器域名确认可达性
- 确认是否需要配置代理

---

### REQUEST_FAILED - 请求失败
**频率**: 罕见（<1%）

**实际案例**:
- `claude-3-haiku-20240307:free`

**原因：**
- 网络连接问题（DNS解析失败、连接超时等）
- 防火墙或安全软件阻止连接
- SSL/TLS证书验证失败
- 代理或VPN配置问题
- 请求在发送过程中被中断

**解决方案：**
1. **检查网络连接**: 
   - 确保能够访问API的base URL
   - 尝试ping或访问API域名
2. **检查系统时间**: SSL证书验证需要正确的系统时间
3. **检查防火墙**: 确保防火墙允许访问API端口（通常是443）
4. **移除代理干扰**: 
   - 如果使用代理，确认代理配置正确
   - 尝试临时禁用代理进行测试
5. **更新SSL证书**: 确保系统SSL证书库是最新的

---

## 响应相关错误

### NO_CONTENT - 无响应内容
**原因：**
- API返回成功但没有实际内容
- 响应格式不符合预期
- 模型未生成任何输出

**解决方案：**
- 检查API返回格式是否符合OpenAI标准
- 确认模型是否支持当前的请求格式
- 尝试修改测试消息：`--message "测试消息"`
- 查看API文档确认正确的响应格式

---

### UNKNOWN_ERROR - 未知错误
**频率**: 罕见（<1%）

**实际案例**:
- `qwen-vl-plus`
- `code-raccoon-v1`
- `cogview-3-flash`

**原因：**
- 模型返回了非标准的错误响应
- API返回了无法解析的错误格式
- 网络连接在传输过程中断开
- Python异常处理未覆盖的特殊情况
- 依赖库版本兼容性问题

**解决方案：**
1. **重试请求**: 可能是临时性网络问题
2. **检查网络**: 确保网络连接稳定
3. **更新依赖**: `pip install -r requirements.txt --upgrade`
4. **查看详细日志**: 如果持续出现，可能需要查看更详细的错误信息
5. **报告问题**: 如果是工具bug，请提交issue并附上模型ID和完整错误信息

---

## 其他常见问题

### 模型列表为空
**错误信息：** `[错误] 未获取到任何模型，请检查API配置`

**原因：**
- API密钥无效
- Base URL错误
- API不支持 `/v1/models` 端点
- 网络连接问题

**解决方案：**
- 确认API密钥和Base URL正确
- 检查API提供商是否支持模型列表接口
- 尝试手动访问 `{base_url}/v1/models` 查看响应
- 检查网络连接

---

### 所有模型都失败
**可能原因：**
- API密钥完全无效
- Base URL配置错误
- 账户余额不足或已被停用
- 网络完全不通

**解决方案：**
- 重新确认所有配置参数
- 在API提供商后台检查账户状态
- 尝试使用官方文档中的示例进行测试
- 检查是否有其他网络设备可以正常访问

---

### 部分模型成功，部分失败
**这是正常情况，可能原因：**
- 不同模型有不同的权限要求
- 某些模型需要额外的购买或申请
- 不同模型的可用性不同
- 测试时某些模型临时不可用

**建议：**
- 关注成功的模型，这些可以正常使用
- 对于失败的模型，查看具体错误信息
- 根据错误信息采取相应的解决措施

---

## 调试建议

1. **详细查看错误信息**：测试结果会显示具体的错误代码，根据本文档查找对应的原因和解决方案

2. **逐步排查**：
   - 首先确认网络连接正常
   - 然后验证API密钥有效
   - 接着确认Base URL正确
   - 最后检查模型权限

3. **使用官方工具测试**：使用API提供商的官方工具或示例代码进行对比测试

4. **查看日志**：如果问题持续，可以修改代码添加更详细的日志输出

5. **联系技术支持**：如果问题无法解决，联系API提供商的技术支持，并提供详细的错误信息

---

## 提高测试成功率的技巧

1. **合理设置超时时间**：根据网络状况和模型复杂度调整 `--timeout` 参数

2. **使用简短的测试消息**：默认的 "hello" 通常最快，避免使用过长的测试文本

3. **错峰测试**：在API使用量较低的时段进行测试，避免遇到速率限制

4. **分批测试**：如果模型数量很多，可以考虑分批次测试，避免触发速率限制

5. **保持工具更新**：定期更新测试工具以支持最新的API变化

---

## 基于实际测试的关键发现

### 测试规模
- **测试模型数**: 1128个
- **成功模型数**: 379个（33.6%）
- **失败模型数**: 749个（66.4%）

### 最常见的问题及占比
1. **HTTP_403 (40-50%)** - 权限不足是最大障碍
   - 建议在大规模测试前先确认可用模型列表
   - 优先测试已知有权限的模型
   
2. **HTTP_429 (20-30%)** - 批量测试容易触发速率限制
   - 测试1000+模型时建议添加延迟
   - 分批测试效果更好
   
3. **HTTP_400 (5-10%)** - 模型类型识别问题
   - 工具已自动处理大部分情况
   - 非标准模型可能需要手动处理

### 成功率最高的提供商
根据实际测试：
- **Moonshot**: 100%成功率
- **Qwen系列**: 90%+成功率
- **Doubao系列**: 85%+成功率
- **OpenAI GPT**: 70%+成功率
- **Claude**: 仅20%成功率（权限限制严重）
- **Gemini**: 40%成功率（速率限制频繁）

### 实用建议
1. **首次使用建议**：
   - 先用小范围测试（10-20个模型）验证配置
   - 确认权限范围后再进行大规模测试
   
2. **大规模测试建议**：
   - 每个请求间隔1-2秒
   - 每100个模型暂停5分钟
   - 使用 `--output` 保存结果，避免重复测试
   
3. **故障排查优先级**：
   - HTTP_403 → 检查账户权限
   - HTTP_429 → 降低测试频率
   - HTTP_400 → 检查模型类型
   - 5xx错误 → 等待后重试

### 性价比最高的可用模型
基于成功率和响应速度：
- `moonshot-v1-128k` - 1.45秒，100%成功
- `gpt-4o-mini` - 1.60秒，稳定可用
- `Qwen2.5-7B-Instruct` - 1.28秒，高成功率
- `Doubao-1.5-pro-32k` - 1.18秒，高成功率

---

## 更新记录

**2025-01-XX**: 基于1128个模型的实际测试结果更新，添加真实案例和频率统计
